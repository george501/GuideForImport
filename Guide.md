# Рукововдство по импорту профиля в Postman

В данной статье мы объясним, как импортировать профиль в базу данных **Altcraft** при помощи программы Postman. После прочтения руководства любой пользователь сможет без труда перенести профиль клиента, не потеряв его данные. Итак, начнём:


![1](https://github.com/george501/GuideForImport/blob/main/logo.png?raw=true)

## Скачайте и установите программу Postman

Для отправки запроса нам понадобится программа **Postman**. Postman — приложение, позволяющее отправлять и принимать API запросы. Актуальную версию приложения можно скачать [на официальном сайте программы](https://www.postman.com/downloads/). Если вы не хотите скачивать Postman на свое устройство, у приложения есть веб-версия. С её помощью можно работать с запросами прямо из браузера.


![2](https://github.com/george501/GuideForImport/blob/main/guide%201.png?raw=true)

Для сохранения своих запросов вам нужно будет зарегестрироваться или войти в уже существующий профиль. При первом запуске программа сама предложит это, а сделать это позже можно нажав на кнопку на верхней панели приложения.


![3](https://github.com/george501/GuideForImport/blob/main/guide2.png?raw=true)

## Создайте новый запрос

Для того чтобы создать нужный нам запрос, нажмите на кнопку **New** рядом в верхней части приложения. Выбираем нужный нам формат (HTTP), перед нами открывается окно с нашим запросом. Нам необходимо также изменить формат запроса с **GET** на **POST**. В URL введите https://example.com/api/v1.1/profiles/get/, где вместо _example.com/_ укажите ссылку на ваш URL.


![4](https://github.com/george501/GuideForImport/blob/main/Ap5CoB5b64%20(1).gif?raw=true)

## Напишите запрос

Для того чтобы написать непосредственно сам запрос, необходимо перейти в раздел **Body**, "тело" нашего запроса, и выбрать режим _raw_. Правее можно выбрать формат запроса, в нашем примере мы используем JSON, но вы можете воспользоваться XML. Ниже появится поле ввода, туда нам необходимо вписать запрос.


![5](https://github.com/george501/GuideForImport/blob/main/guide%203.png?raw=true)

## Параметры запроса

В запросе должны быть прописаны обязательные параметры, без которых запрос невозможно послать. Также есть необязательные параметры запроса и массив subscriptions. Массив хранит данные о подписках профиля на ресурсы. Для каждой подписки нужно указать отдельный параметр.

### Обязательные параметры 

|Параметр | Описание                                                                                    |
|---------|---------------------------------------------------------------------------------------------|
| `token`   | API токен. Токен необходим для авторизации, его можно найти в панели пользователя платформы |
| `db_id`   | идентификатор базы данных                                                                   |
| `data`    | данные о профиле, включая подписки                                                          |

> [!NOTE]
> Параметр _matching_ не обязателен, если вы ищете по email из профиля или подписок

### Необязательные параметры

|Параметр | Описание                                                                                    |
|---------|---------------------------------------------------------------------------------------------|
| `matching` | Режим поиска подписчика. По умолчанию - email |
| `skip_triggers` | Пропустить запуск триггеров (по умолчанию – false) |
| `skip_invalid_subscriptions` |	Пропустить невалидные подписки (по умолчанию – false) |
| `detect_geo` |	Включает автоопределение geo данных по полю _regip или _ip в data |
| `add_to_segments` |	Добавление профиля в сегмент |
| `remove_from_segments` | Удаление профиля из сегмента |

### Массив subscriptions

|Параметр | Описание                                                                                    |
|---------|---------------------------------------------------------------------------------------------|
| `resource_id` | Идентификатор ресурса |
| `status` | Статус подписки |
| `priority` | Приоритет подписки |
| `custom_fields` | Стандартные и дополнительные поля подписки |
| `cats` | Категории ресурса, на которые подписать профиль |
| **Email канал** |
| `channel` | Тип канала |
| `email` | Email-адрес |
| **SMS канал** |
| `channel` | Тип канала |
| `phone` | Номер телефона |
| **Push канал** |
| `channel` | Тип канала |
| `provider` | Тип провайдера |
| `subscription_id`	| Идентификатор подписки |
| **Telegram Bot канал**: |
| `channel` | Тип канала |
| `cc_data` | id чата в Telegram-бот |
| **WhatsApp канал**: |
| `channel` | Тип канала |
| `cc_data` | Телефон профиля в WhatsApp |
| **Viber канал**: |
| `channel` | Тип канала |
| `cc_data` | Телефон профиля в Viber |


### Пример готового запроса

```JSON
{
     "token": "91f1dfa81c264a938b475677c60ce967",
     "db_id": 1,
     "matching": "email",
     "email": "example@example.com",
     "detect_geo": true,
     "data": {
        "_fname": "Olly",
        "_lname": "Lambert",

        "email": "example@example.com",
        "phones": ["+79000000000"],
        "subscriptions": [
            {
                "channel": "email",
                "email": "example@example.com",
                "resource_id": 2,
                "custom_fields": {
                    "_browser_name": "Firefox",
                    "_device_type": "web",
                    "custom_field_1": "test value"
                },
                "cats": [
                    "category_1",
                    "category_2"
                ]
            },
            {
                "channel": "sms",
                "phone": "+79000000000",
                "resource_id": 1
            },
            {
                "channel": "push",
                "subscription_id": "a81c264a938b475",
                "provider": "android-firebase",
                "resource_id": 1
            },
            {
                "channel": "telegram_bot",
                "cc_data": {"user_chat_id"}
            },
            {
                "channel": "whatsapp",
                "cc_data": {"user_phone"}
            },
            {
                "channel": "viber",
                "cc_data": {"user_phone"}
            }
        ],
        "_bdate": "1990-02-22T21:00:00Z",
        "_sex": 0,

        "_regdate": "2019-03-14T22:00:00Z",
        "_regip": "94.231.119.122",
        "_ip": "94.231.119.122",

        "_tz": "Europe/Moscow",
        "_postal_code": "390000",

        "_os": "Windows 10",
        "_browser": "Firefox",

        "_vendor": "form_#31",

        "custom_field": "custom_value"
    }
}
```

## Отправьте запрос

Когда ваш запрос будет полностью готов, нажмите на кнопку **Send**. Если запрос успешно отправлен, в окне внизу появится ответ:

```JSON
{
  "error": 0,
  "error_text": "Successful operation",
  "profile_id": "54759eb3c090d83494e2d804"
}
```

где _"profile_id"_ это ID импортированного профиля в базе данных

## Проверьте, появился ли профиль в базе данных

После того, как запрос будет отправлен, вы можете проверить, верно ли отображается профиль в базе данных с помощью запроса:

```JSON
{
    "db_id": 1,
    "email": "john@example.com",
    "token": "abcdefghijklmnqrstuvwxyz"
}
```

где _db_id_ - идентификатор базы данных, _token_ - ваш API токен, а _email_ - электронная почта, по которой будет найден профиль. 

## 

Поздравляем! Если вы получили сообщение об успехе и нашли профиль с помощью запроса, значит у вас всё получилось. В случае, если вы получаете ошибку в ответе на ваш запрос, прочтите описание ошибки и попробуйте устранить её. Если это не помогло, сообщите нам в Telegram. 
